Fixes CVE-2023-5752.
Desc:
  When installing a package from a Mercurial VCS URL (ie "pip install hg+..."),
  the specified Mercurial revision could be used to inject arbitrary configuration
  options to the "hg clone" call (ie "--config"). Controlling the Mercurial
  configuration can modify how and which repository is installed.

Upstream changes:
https://github.com/pypa/pip/pull/12306
https://github.com/pypa/pip/pull/12373

Rebased onto out version of pip.

--- pip-23.0.1/src/pip/_internal/vcs/mercurial.py
+++ pip-23.0.1/src/pip/_internal/vcs/mercurial.py
@@ -31,7 +31,7 @@ class Mercurial(VersionControl):
 
     @staticmethod
     def get_base_rev_args(rev: str) -> List[str]:
-        return [rev]
+        return [f"--rev={rev}"]
 
     def fetch_new(
         self, dest: str, url: HiddenText, rev_options: RevOptions, verbosity: int
--- pip-23.0.1/tests/unit/test_vcs.py
+++ pip-23.0.1/tests/unit/test_vcs.py
@@ -66,7 +66,7 @@ def test_rev_options_repr() -> None:
         # First check VCS-specific RevOptions behavior.
         (Bazaar, [], ["-r", "123"], {}),
         (Git, ["HEAD"], ["123"], {}),
-        (Mercurial, [], ["123"], {}),
+        (Mercurial, [], ["--rev=123"], {}),
         (Subversion, [], ["-r", "123"], {}),
         # Test extra_args.  For this, test using a single VersionControl class.
         (
