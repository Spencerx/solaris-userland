This is an upstream patch. Will be removed once we got the change from
distribution.

From 262c909ac5b8676d1c221584c5a760e5e83fae66 Mon Sep 17 00:00:00 2001
From: Zdenek Dohnal <zdohnal@redhat.com>
Date: Mon, 4 Sep 2023 17:07:14 +0200
Subject: [PATCH] raster-interpret.c: Fix CVE-2023-4504

We didn't check for end of buffer if it looks there is an escaped
character - check for NULL terminator there and if found, return NULL
as return value and in `ptr`, because a lone backslash is not
a valid PostScript character.
---
 ppd/raster-interpret.c | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

--- cups-2.4.6/cups/raster-interpret.c
+++ cups-2.4.6/cups/raster-interpret.c
@@ -1113,7 +1113,19 @@ */
 
 	    cur ++;
 
-            if (*cur == 'b')
+	   /*
+	    * Return NULL if we reached NULL terminator, a lone backslash
+            * is not a valid character in PostScript.
+	    */
+
+	    if (!*cur)
+	    {
+	      *ptr = NULL;
+
+	      return (NULL);
+	    }
+
+	    if (*cur == 'b')
 	      *valptr++ = '\b';
 	    else if (*cur == 'f')
 	      *valptr++ = '\f';
